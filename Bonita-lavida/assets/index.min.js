$(window).on('load',function(){
    // console.log('aaa')
    $('#loading').delay(1000).fadeOut(1800);
    setTimeout(() => {
        animated();
        $('.banner-home').ready(function(){
            smoke();
            smokeA();
        }) 
        AOS.init({
            duration: 1500,
            once: true,
        });
    }, 1100);
 });
$('.lang').on('click',function(){
    $('ul', this).slideToggle();
})
$('.lang-mb').on('click', function(){
    console.log('aaa')
    $('ul',this).slideToggle();
})
$(document).on('click',function(e){
    // if ($('.lang').length === 0) {
    //     console.log('aaa')
    // }
    if ($(e.target).closest('.lang-mb').length === 0) {
        // $("#CONTAINER").hide();
        $('.lang-mb ul').slideUp();
    }
    if ($(e.target).closest('.lang').length === 0) {
        // $("#CONTAINER").hide();
        $('.lang ul').slideUp();
    }
})
// Hide Header on on scroll down
var didScroll;
var lastScrollTop = 0;
var delta = 5;
var navbarHeight = $('header').outerHeight();

$(window).scroll(function(event){
    didScroll = true;
});

setInterval(function() {
    if (didScroll) {
        hasScrolled();
        didScroll = false;
    }
}, 250);

function hasScrolled() {
    var st = $(this).scrollTop();
    
    // Make sure they scroll more than delta
    if(Math.abs(lastScrollTop - st) <= delta)
        return;
    
    // If they scrolled down and are past the navbar, add class .nav-up.
    // This is necessary so you never see what is "behind" the navbar.
    if (st > lastScrollTop && st > navbarHeight){
        // Scroll Down
        $('header').removeClass('nav-down').addClass('nav-up');
    } else {
        // Scroll Up
        if(st + $(window).height() < $(document).height()) {
            $('header').removeClass('nav-up').addClass('nav-down');
        }
    }
    
    lastScrollTop = st;
}
function smoke() {
    var wow = new WOW({
        boxClass: 'smoke-animation',
        animateClass: 'smoke-animated',
        offset: 100,
        mobile: !0,
        live: !0,
    });
    wow.init()
}
function smokeA() {
    var wow = new WOW({
        boxClass: 'smoke-animation-1',
        animateClass: 'smoke-animated',
        offset: 200,
        mobile: !0,
        live: !0,
    });
    wow.init()
}
function animated() {
    var wow = new WOW({
        boxClass: 'animation',
        animateClass: 'animate__animated',
        offset: 200,
        mobile: !0,
        live: !0,
    });
    wow.init()
}

// smoke();
$('.swiper-offer').each(function (index) {
    var swiperOffer = new Swiper($(this)[0],{
        spaceBetween: 0,
        slidesPerView: 1,
        navigation: {
            nextEl: '.sub-next',
            prevEl: '.sub-prev',
          },
          breakpoints: {
            // when window width is >= 320px
            320: {
              slidesPerView: 1,
              spaceBetween: 0
            },
            // when window width is >= 480px
            768: {
              slidesPerView: 2,
              spaceBetween: 0
            },
            992: {
              slidesPerView: 3,
              spaceBetween: 0
            }
        },
        // on: {
        //     init: function init() {
        //         var _this = this;
        //         setTimeout(function () {
        //             _this.update();
        //         }, 300);
        //     }
        // }
    })
});
// var swiperOffer = new Swiper('.swiper-offer', {
//     slidesPerView: 1,
//     spaceBetween: 25,
//     navigation: {
//         nextEl: '.sub-next',
//         prevEl: '.sub-prev',
//       },
//       breakpoints: {
//         // when window width is >= 320px
//         320: {
//           slidesPerView: 1,
//           spaceBetween: 20
//         },
//         // when window width is >= 480px
//         768: {
//           slidesPerView: 2,
//           spaceBetween: 20
//         },
//         // when window width is >= 640px
//         992: {
//           slidesPerView: 2,
//           spaceBetween: 30
//         }
//     },
//     on: {
//         init: function init() {
//             var _this = this;
//             setTimeout(function () {
//                 _this.update();
//             }, 300);
//         }
//     }
// })

var swiperTest = new Swiper('.swiper-testimonial', {
    slidesPerView: 1,
    loop: true,
    speed: 1500,
    autoplay: {
        delay: 8000,
        disableOnInteraction: false,
    },
    autoHeight: true,
    // spaceBetween: 100,
    effect: 'fade',
    pagination: {
        el: '.swiper-pagination',
        type: 'bullets',
        clickable: true,
    },
})


var swiperHome = new Swiper('.swiper-banner-home', {
    slidesPerView: 1,
    effect: 'fade',
    
    loop: true,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    pagination: {
        el: '.swiper-pag-home',
        type: 'bullets',
        clickable: true,
        renderBullet: function (index, className) {
            return '<span class="' + className + '">' + '0' + (index + 1) + '</span>';
        }
    },
    
});



$('.banner-home').each(function(){
    var a = swiperHome.slides.length;
    var counter = $('.current-slide');
    var total = $('.total-slide');
    totalCount = $('<span class="total">' + a + '</span>');

    total.html(totalCount);
    var currentCount = $('<span class="count">1</span>');
    counter.append(currentCount);

    swiperHome.on('transitionStart', function () {
        var index = this.activeIndex + 1;

        var prevCount = $('.count');
        currentCount = $('<span class="count next">' + index + '</span>');
        counter.html(currentCount);
    });
})



var swiperFood = new Swiper('.swiper-food', {
    effect: 'coverflow',
    slidesPerView: 'auto',
    grabCursor: true,
    loop: true,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    centeredSlides: true,
    coverflowEffect: {
        rotate: 0,
        stretch: 100,
        depth: 270,
        modifier: 1,
        slideShadows: false,
    },
});


var galleryThumbs = new Swiper('.swiper-thumb-massage', {
    spaceBetween: 10,
    slidesPerView: 2,
    speed: 1500,
    grabCursor: true,
    // loop: true,
    // autoplay: {
    //     delay: 5000,
    //     disableOnInteraction: false
    //   }, 
    // freeMode: true,
    loopedSlides: 5, 
    watchSlidesVisibility: true,
    watchSlidesProgress: true,
  });
var galleryTop = new Swiper('.swiper-massage', {
    allowTouchMove: false,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    // preventInteractionOnTransition: true,    
    // grabCursor: false,
    // loop: true,
    effect: 'fade',
    loopedSlides: 5, 
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    thumbs: {
      swiper: galleryThumbs,
    },
});

var swiperWedding = new Swiper('.swiper-wedding', {
    slidesPerView: 1,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    effect: 'fade',
})

var swiperAward = new Swiper('.swiper-award', {
    slidesPerView: 2,
    spaceBetween: 10,
    allowTouchMove: false,
    speed: 1500,
    loop: true,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    breakpoints: {
        // when window width is >= 320px
        320: {
          slidesPerView: 3,
          spaceBetween: 20
        },
        // when window width is >= 480px
        768: {
          slidesPerView: 5,
          spaceBetween: 20
        },
        // when window width is >= 640px
        992: {
          slidesPerView: 6,
          spaceBetween: 30
        }
    }
});

var swiperSubpage = new Swiper('.swiper-sub-page', {
    slidesPerView: 1,
    effect: "fade",
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    navigation: {
        nextEl: '.sub-next',
        prevEl: '.sub-prev',
      },
});

var names = [];
$(".swiper-promotion .swiper-wrapper .swiper-slide").each(function() {
    names.push($(this).data("name"));
});
var swiperPromotion = new Swiper('.swiper-promotion', {
    slidesPerView: 1,
    allowTouchMove: false,
    effect: "fade",
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    navigation: {
        nextEl: '.sub-next',
        prevEl: '.sub-prev',
    },
    pagination: {
        el: '.pag-pro',
        clickable: true,
       
            renderBullet: function renderBullet(index, className) {
                return '<span class="tab__link ' + className + '">' + '<span class="tab__number">' + '</span>' + names[index] + '</span>';
            }
    
    }
    
});


$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
    e.target;
    e.relatedTarget; 
    swiperPromotion.update();
})



var swiperSubpage = new Swiper('.swiper-other-room', {
    slidesPerView: 1,
    spaceBetween: 30,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    navigation: {
        nextEl: '.sub-next',
        prevEl: '.sub-prev',
    },
    breakpoints: {
        // when window width is >= 320px
        320: {
          slidesPerView: 1,
          spaceBetween: 20
        },
        576: {
            slidesPerView: 2,
            spaceBetween: 20
        },
        // when window width is >= 480px
        768: {
          slidesPerView: 2,
          spaceBetween: 20
        },
        // when window width is >= 640px
        992: {
          slidesPerView: 3,
          spaceBetween: 30
        }
    }
})
var swiperSubpage1 = new Swiper('.swiper-press-room', {
    slidesPerView: 3,
    spaceBetween: 30,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    navigation: {
        nextEl: '.sub-next',
        prevEl: '.sub-prev',
      },
});


var swiperSubpage = new Swiper('.swiper-detail-room', {
    slidesPerView: 1,
    effect: 'fade',
    spaceBetween: 30,
    speed: 1500,
    autoplay: {
        delay: 5000,
        disableOnInteraction: false,
    },
    navigation: {
        nextEl: '.sub-next',
        prevEl: '.sub-prev',
      },
      pagination: {
        el: '.swiper-pagination',
        type: 'bullets',
      },
});
var footerH = $('footer').height() + 100;
// console.log(footerH);


$('a[data-toggle="tab"]').on('click', function(){
    $('html, body').animate({
        scrollTop: $(".room-top").offset().top
    }, 500);
});

// $('.menu-sub a').on('click', function(){
//     $('html, body').animate({
//         scrollTop: $(".room-top").offset().top
//     }, 500);
// })

// handle links with @href started with '#' only
$(document).on('click', '.menu-sub a[href^="#"]', function(e) {
    // target element id
    var id = $(this).attr('href');

    // target element
    var $id = $(id);
    if ($id.length === 0) {
        return;
    }

    // prevent standard hash navigation (avoid blinking in IE)
    e.preventDefault();

    // top position relative to the document
    var pos = $id.offset().top;
    console.log(pos)
    // animated top scrolling
    $('body, html').animate({scrollTop: pos});
});








$('.has-sub a').on('click', function(){
    $('.has-sub').removeClass('active');
    $(this).closest('.has-sub').addClass('active');
    // if ($('.nav-link',this).hasClass('active')){
    //     $('.nav-link.active').closest('.has-sub').addClass('active');
    // }
    // else {
    //     $('.nav-link.active').closest('.has-sub').removeClass('active');
    // }
})


$(window).scroll(function() {
    var header = $('.banner-subpage').height();
    var top = $('.room-top').height();
    var scrollDistance = $(window).scrollTop() - header - top ;

    // Show/hide menu on scroll
    //if (scrollDistance >= 850) {
    //		$('nav').fadeIn("fast");
    //} else {
    //		$('nav').fadeOut("fast");
    //}

    // Assign active class to nav links while scolling
    $('.section-sus').each(function(i) {
            if ($(this).position().top <= scrollDistance) {
                    $('.menu-sub a.active').removeClass('active');
                    $('.menu-sub a').eq(i).addClass('active');
            }
    });
}).scroll();

$('#main-navigation-toggle').on('change', function(){
    if ($(this).prop( "checked" )) {
        // console.log('aaa')
        $('body').addClass('ov-hidden');
    }
    else {
        $('body').removeClass('ov-hidden');
    }
})
 
$('.has-sub-mb').on('click', function(){
    $('.submenu',this).slideToggle();
})

$.fn.toggleText = function(t1, t2){
    if (this.text() == t1) this.text(t2);
    else                   this.text(t1);
    return this;
};

// $('.btn.btn-link').on('click',function(){
//     console.log('aaa')
//     $('html, body').animate({
//         scrollTop: $(this).offset().top
//     }, 500);
// })

$('.collap-reason').on('show.bs.collapse', function () {
    // console.log('aaaa')
    $('html, body').animate({
        scrollTop: $(this).offset().top
    }, 500);
});
// var myLazyLoad = new LazyLoad({
//     elements_selector: "img"
// });
function sticky() {
    if ($(window).width() < 992) {
        $('.menu-offer').unstick();
    }
    else {
        $('.menu-offer').sticky({topSpacing:100,bottomSpacing:footerH});
    }
}
sticky();
$(window).resize(function(){
    sticky();
});


function logElementEvent(eventName, element) {
    console.log(Date.now(), eventName, element.getAttribute("data-src"));
  }

  var ll = new LazyLoad({
      elements_selector: ".lazy",
    class_applied: "lz-applied",
    class_loading: "lz-loading",
    class_loaded: "lz-loaded",
    class_error: "lz-error"
  });

  $(document).ready(function(){
    $('a[href*="#"]:not([href="#"])').click(function() {
        var target = $(this.hash);
          $('html,body').stop().animate({
            scrollTop: target.offset().top - 0
          }, 'linear');   
    });   
      if (location.hash){
      var id = $(location.hash);
      }
    //   $('html,body').animate({
    //     scrollTop: $(location.hash).offset()
    //   });
    //   $('html, body').hide();
    //   if (window.location.hash) {
    //     setTimeout(function() {
    //         $('html, body').scrollTop(0).show();
    //         $('html, body').animate({
    //             scrollTop: $(window.location.hash).offset().top
    //             }, 1000)
    //     }, 0);
    // }
    // else {
    //     $('html, body').show();
    // }
      $(window).on('load', function() {
          console.log(location.hash)
            if (location.hash){
                setTimeout(function() {
                    $('html, body').scrollTop(0).show();
                    $('html,body').delay(1000).animate({scrollTop: id.offset().top - 0}, 'linear')
                }, 0);
                
            };
       });
  });
